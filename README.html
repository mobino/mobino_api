<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.3" />
<title>Mobino API Documentation</title>
<style type="text/css">
/* Sans-serif font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
div#toctitle,
span#author, span#revnumber, span#revdate, span#revremark,
div#footer {
  font-family: Arial,Helvetica,sans-serif;
}

/* Serif font. */
div.sectionbody {
  font-family: Georgia,"Times New Roman",Times,serif;
}

/* Monospace font. */
tt {
  font-size: inherit;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  font-size: inherit;
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revnumber, span#revdate, span#revremark {
}

div#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #777777;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  div#footer-badges { display: none; }
}

div#toc {
  margin-bottom: 2.5em;
}

div#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

</style>
<script type="text/javascript">
/*<![CDATA[*/
window.onload = function(){asciidoc.footnotes();}
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  var cont = document.getElementById("content");
  var noteholder = document.getElementById("footnotes");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      // Use [\s\S] in place of . so multi-line matches work.
      // Because JavaScript has no s (dotall) regex flag.
      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      spans[i].innerHTML =
        "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
        "' title='View footnote' class='footnote'>" + n + "</a>]";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
}

}
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Mobino API Documentation</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_what_is_mobino">What is Mobino</h2>
<div class="sectionbody">
</div>
</div>
<div class="sect1">
<h2 id="_how_do_i_get_paid_with_mobino">How do I get paid with Mobino</h2>
<div class="sectionbody">
</div>
</div>
<div class="sect1">
<h2 id="_the_api">The API</h2>
<div class="sectionbody">
<div class="paragraph"><p>Mobino uses a simple REST based JSON API. All requests and responses are
transfered in JSON format over HTTP.</p></div>
<div class="sect2">
<h3 id="_preparations">Preparations</h3>
<div class="paragraph"><p>Before you can start to use the Mobino API you will need to setup API keys and
secrets. These are generated automatically for you when your merchant account
is created. You can change them anytime by going to your profile page and
clicking "Create API credentials" in the Edit form of your profile.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">As soon as you change the credentials, any applications you have that use
the old pair of credentials will stop working.</td>
</tr></table>
</div>
<div class="paragraph"><p>In addition, you will need to provide a callback URL that we call upon a
successful transaction. Details to be found in the section <em>Callback URL</em>.</p></div>
<div class="sect3">
<h4 id="_api_credentials">API Credentials</h4>
<div class="paragraph"><p>The <tt>API key</tt> is used to identify you to the Mobino payment application. The
<tt>API Secret</tt> is used to sign your calls to us. While the key is public and
transmitted in the clear, the secret is never published and you should keep it
guarded.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="_using_the_mobino_widget">Using the Mobino Widget</h3>
<div class="paragraph"><p>The simplest way to use Mobino is by using the provided Mobino Widget.</p></div>
<div class="paragraph"><p>Mobino provides you with a JavaScript widget that you can embed on the page
where a sale is being made. Here&#8217;s the code you need to put where you want the
button to appear:</p></div>
<div class="listingblock">
<div class="title">Minimal sample invocation of Mobino Widget:</div>
<div class="content">
<pre><tt>&lt;div id="mobino"&gt;
  &lt;script src="http://mobino.com/api/v1/mobino.js"&gt;&lt;/script&gt;
  &lt;script&gt;
    Mobino.createButton({
      transaction: {
        amount: '10.00',
        merchant_id: 99,
        api_key: 'YOUR_API_KEY',
        reference_number: '70824',
        transaction_type: 'regular',
        signature: 'CALCULATED_SIGNATURE'
      }
    });
  &lt;/script&gt;
&lt;/div&gt;</tt></pre>
</div></div>
<div class="listingblock">
<div class="title">Full sample invocation of Mobino Widget:</div>
<div class="content">
<pre><tt>&lt;div id="mobino"&gt;
  &lt;script src="http://mobino.com/api/v1/mobino.js"&gt;&lt;/script&gt;
  &lt;script&gt;
    Mobino.createButton({
      lang: 'fr',
      country: 'CH',
      env: 'staging',
      callback: 'http://example.com/paymentCompleted.html',
      transaction: {
        amount: '2.50',
        merchant_id: 123,
        api_key: 'YOUR_API_KEY',
        reference_number: '79748',
        transaction_type: 'regular',
        signature: 'CALCULATED_SIGNATURE'
      }
    });
  &lt;/script&gt;
&lt;/div&gt;</tt></pre>
</div></div>
<div class="paragraph"><p>The parameters are as follows:</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<tt>env</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Optional Parameter: Select the environment where you want to create the payment.
  <em>production</em> is the default environment.
  <em>staging</em> is a sandbox environment.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>lang</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Optional Parameter: Select the language of the widget and popup.
  <em>en</em> selects English, the default.
  <em>fr</em> selects French.
  <em>de</em> selects German.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>country</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Optional Parameter: Overrides the country-detection, based on GeoIP.
The Country code has to be in capitals. Currently supported:
  <em>UK</em> selects Great Britain, the default.
  <em>CH</em> selects Switzerland.
  <em>FR</em> selects France.
  <em>DE</em> selects Germany.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>callback</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Optional Parameter: If passed a string the user will be redirected to this page
when he successfully completed his transaction. If passed a function the function is called
with <tt>'success'</tt> when the transaction was successful and with <tt>'failure\'</tt> if the transaction
was unsuccessful. <strong>Note:</strong> This is only there to improve the user experience and you need to
use the server callback to verify the payment.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>transaction</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
The transaction that should be started when the user clicks on the button.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>transaction.amount</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
The amount to charge in Euro&#8217;s and Cent&#8217;s, formatted as a string.
Separator of Euros and Cents is a <tt>.</tt> (dot), not a comma. No other formatting
is allowed (thousand separators etc.)
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>transaction.merchant_id</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Your merchant id. Will be provided to you by us.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>transaction.api_key</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
The API key found discussed above.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>transaction.reference_number</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
An <em>optional</em> reference number that you can use to track
the payment. We will provide you this reference number in the callback we do on
a successful transaction.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>transaction.transaction_type</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Either <tt>regular</tt> or <tt>gift</tt>. A regular transaction is one,
where you bill your customer and get paid. A gift transaction is one where you
provide some (virtual) gift to the customer (no money is being transfered)
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<tt>transaction.signature</tt>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
A signature of the parameters. See section on <em>Signature</em>
</p>
</td>
</tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_signature">Signature</h3>
<div class="paragraph"><p>In order to protect the integrity of your call to Mobino, you will need to
provide a computed signature. This signature is generated using a one way Hash
function using the parameters you provide and the <em>API Secret</em> we provide to
you.</p></div>
<div class="paragraph"><p>Basically, you will need to sort the parameters, convert them into a string,
append your secret and then run the Hash function on it.</p></div>
<div class="paragraph"><p>We have code in some languages and will expand this as time goes by. Check out
the different subfolders to see how the parameters are handled.</p></div>
<div class="paragraph"><p>Here&#8217;s a step by step walk through:</p></div>
<div class="listingblock">
<div class="title">Original parameters</div>
<div class="content">
<pre><tt>{'amount':'10.0', 'reference_number': '70824', 'merchant_id': 99, 'transaction_type': 'regular', 'api_key':'YOUR_API_KEY'}</tt></pre>
</div></div>
<div class="listingblock">
<div class="title">Normalize the parameters</div>
<div class="content">
<pre><tt>{'amount':'10.00', 'reference_number': '70824', 'merchant_id': 99, 'transaction_type': 'regular', 'api_key':'YOUR_API_KEY'}</tt></pre>
</div></div>
<div class="paragraph"><p>Normalization formats the amount with the following pattern:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>sprintf "%.2f", params['amount']</tt></pre>
</div></div>
<div class="paragraph"><p>which formats it with two decimal digits.</p></div>
<div class="listingblock">
<div class="title">Sort parameters</div>
<div class="content">
<pre><tt>{'amount': '10.00', 'api_key': 'YOUR_API_KEY', 'merchant_id': 99, 'reference_number': '70824', 'transaction_type': 'regular'}</tt></pre>
</div></div>
<div class="listingblock">
<div class="title">Stringify them</div>
<div class="content">
<pre><tt>'amount:10.00,api_key:YOUR_API_KEY,merchant_id:99,reference_number:70824,transaction_type:regular'</tt></pre>
</div></div>
<div class="paragraph"><p>All the parameters are stored in one string. Key / Value are separated with a
<tt>:</tt> and the pairs are separated with commas.</p></div>
<div class="listingblock">
<div class="title">Prepare for signature creation</div>
<div class="content">
<pre><tt>'amount:10.00,api_key:YOUR_API_KEY,merchant_id:99,reference_number:70824,transaction_type:regularAPI_SECRET'</tt></pre>
</div></div>
<div class="paragraph"><p>The <em>API Secret</em> is appended to the string.</p></div>
<div class="listingblock">
<div class="title">Generate signature</div>
<div class="content">
<pre><tt>Digest::MD5.hexdigest('amount:10.00,api_key:YOUR_API_KEY,merchant_id:99,reference_number:70824,transaction_type:regularAPI_SECRET')
=&gt; "2ca37559b8cc7a1ae3b6089c59a4d97a"</tt></pre>
</div></div>
<div class="paragraph"><p>This signature is then appended to the paramters:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt>{'amount': '10.00', 'api_key': 'YOUR_API_KEY', 'merchant_id': 99, 'reference_number': '70824',  'transaction_type': 'regular', 'signature' : '2ca37559b8cc7a1ae3b6089c59a4d97a'}</tt></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">On the receiving side, the procedure is repeated (especially the sorting
of the paramters and the formatting of the amount parameter). Therefore you can
pass the parameters in random order - the signatures will be created correctly.</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_callback_url">Callback URL</h2>
<div class="sectionbody">
<div class="paragraph"><p>You provide us with a callback URL in the admin interface and we will call you
on the end of a transaction with the following information:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<tt>status</tt>
</dt>
<dd>
<p>
The status of the transaction. One of <em>authorized</em> or
<em>unauthorized</em>. If you receive <em>authorized</em>, the transaction was completed
successfully, and you will be credited the amount. If the transaction is
unauthorized, then the customer didn&#8217;t approve the transaction.
</p>
</dd>
<dt class="hdlist1">
<tt>amount</tt>
</dt>
<dd>
<p>
The amount of the transaction (formatted with two decimal digits)
</p>
</dd>
<dt class="hdlist1">
<tt>reference_number</tt>
</dt>
<dd>
<p>
The reference number you passed in when you generated the
request for a transaction
</p>
</dd>
<dt class="hdlist1">
<tt>api_key</tt>
</dt>
<dd>
<p>
your API key
</p>
</dd>
<dt class="hdlist1">
<tt>signature</tt>
</dt>
<dd>
<p>
The signature for the above parameters
</p>
</dd>
</dl></div>
<div class="paragraph"><p>At the moment, the parameters are returned url-encoded. In the future, you will
be able to select either JSON or URL encoding.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_writing_your_own_widget">Writing your own widget</h2>
<div class="sectionbody">
<div class="paragraph"><p>It is of course possible to work without the mobino widget. You will need to
call our API directly. This is a two-step process. First, you need to generate
a token for your transaction. Second, you need to poll the service for the state
of the transaction.</p></div>
<div class="sect2">
<h3 id="_step_1_retrieve_a_token">Step 1: Retrieve a token</h3>
<div class="paragraph"><p>Call the URL <tt>http://merchants.mobino.com/tokens.js</tt> with the following parameters:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top"> Parameter             </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>amount</tt></p></td>
<td align="left" valign="top"><p class="table">the amount of the transaction (formatted with two decimal digits)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>merchant_id</tt></p></td>
<td align="left" valign="top"><p class="table">your merchant id</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>api_key</tt></p></td>
<td align="left" valign="top"><p class="table">your API key</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>reference_number</tt></p></td>
<td align="left" valign="top"><p class="table">a reference number for that will be passed back to your server</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>transaction_type</tt></p></td>
<td align="left" valign="top"><p class="table">the type of the transaction, either <tt>regular</tt> or <tt>gift</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>signature</tt></p></td>
<td align="left" valign="top"><p class="table">a signature over all above parameters as described in the section <em>Signature</em></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>callback</tt> (optional)</p></td>
<td align="left" valign="top"><p class="table">if this parameter is passed, the JSON response will be wrapped in a function call to allow cross domain JSONP requests.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The response will be a JSON object with the following field:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top"> Field         </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>token</tt> (int)</p></td>
<td align="left" valign="top"><p class="table">the token</p></td>
</tr>
</tbody>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre><tt>GET /api/v1/tokens.json?amount=2.50&amp;merchant_id=1&amp;api_key=YOUR_KEY&amp;reference_number=79748&amp;transaction_type=regular&amp;signature=CALCULATED_SINATURE

{"token":1234}</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_step_2_monitoring_the_status_of_a_transaction">Step 2: Monitoring the status of a transaction</h3>
<div class="paragraph"><p>To retrieve the status of the transaction you can call the URL <tt>/api/v1/transactions.json</tt>
with the following parameters:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top"> Parameter             </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>reference_number</tt></p></td>
<td align="left" valign="top"><p class="table">the reference number of the current transaction</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>merchant_id</tt></p></td>
<td align="left" valign="top"><p class="table">your merchant id</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>token</tt></p></td>
<td align="left" valign="top"><p class="table">the token you retrieved in step 1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>callback</tt> (optional)</p></td>
<td align="left" valign="top"><p class="table">if this parameter is passed, the JSON response will be wrapped in a function call to allow cross domain JSONP requests.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>The response will be a JSON object with the following fields:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top"> Field                    </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>message</tt> (string)</p></td>
<td align="left" valign="top"><p class="table">a human readable message describing the next step</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>message_class</tt> (string)</p></td>
<td align="left" valign="top"><p class="table">the transaction status, either <tt>\"in_progress\"</tt>, <tt>\"success\"</tt>, or <tt>\"failure\"</tt></p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>retry</tt> (boolean)</p></td>
<td align="left" valign="top"><p class="table">a bool indicating wheather or not you should ping again, false if the transaction failed or is completed</p></td>
</tr>
</tbody>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre><tt>GET /api/v1/transaction.json?reference_number=79748&amp;merchant_id=YOUR_MERCHANT_ID&amp;token=TOKEN

{
  "message": "Your transaction is being processed. Please enter your PIN on the telephone.",
  "message_class": "in_progress",
  "retry": true
}</tt></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_optional_return_telephone_number_to_call">Optional: Return telephone number to call</h3>
<div class="paragraph"><p>In order to show the buyer the local telephone number for Mobino, you can ask
Mobino for the preferred telephone number based on the buyers IP and an
optional language:</p></div>
<div class="paragraph"><p>Call the URL <tt>http://merchants.mobino.com/api/v1/preferred_phone_numbers</tt> with
the following parameters:</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top"> Parameter </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><tt>ip</tt></p></td>
<td align="left" valign="top"><p class="table">the ip address of the buyer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><tt>lang</tt></p></td>
<td align="left" valign="top"><p class="table">the default language preferred</p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>This call returns a JSON object with the following fields</p></div>
<div class="tableblock">
<table rules="all"
width="100%"
frame="border"
cellspacing="0" cellpadding="4">
<col width="50%" />
<col width="50%" />
<thead>
<tr>
<th align="left" valign="top"> Name             </th>
<th align="left" valign="top"> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">country</p></td>
<td align="left" valign="top"><p class="table">the country that the buyer is in</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">preferred_number</p></td>
<td align="left" valign="top"><p class="table">Array with [country, language, phone_number]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">other_numbers</p></td>
<td align="left" valign="top"><p class="table">Array with all other possible phone numbers (in same format as preferred_number</p></td>
</tr>
</tbody>
</table>
</div>
<div class="listingblock">
<div class="title">Example</div>
<div class="content">
<pre><tt>GET /api/v1/preferred_phone_numbers?ip=12.12.12.12&amp;lang=de

{ "country": "CH",
  "preferred_number": { "country": "CH",
                        "language": "de",
                        "phone_number": "+41 43 508 05 18"},
  "other_numbers": [{ "country": "CH",
                      "language": "fr",
                      "phone_number": "+41 22 123 12 12"},
                    { "country": "DE",
                      "language": "de",
                      "phone_number": "+49 30 123 123 12"}]
}</tt></pre>
</div></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2011-04-01 17:58:48 CEST
</div>
</div>
</body>
</html>
